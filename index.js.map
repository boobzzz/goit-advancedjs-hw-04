{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/messages.js","../src/js/render-functions.js","../src/js/spinner.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49648507-d50f841642650241279dda9b6';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\nlet currentPage = 1;\nlet currentQuery = '';\n\nexport async function processSearchResults(query, { onStart, onSuccess, onError, onFinally }) {\n  onStart();\n  currentPage = 1;\n  currentQuery = query;\n\n  await fetchImages({ onSuccess, onError, onFinally });\n}\n\nexport async function loadMoreSearchResults({ onStart, onSuccess, onError, onFinally }) {\n  onStart();\n  currentPage++;\n\n  await fetchImages({ onSuccess, onError, onFinally });\n}\n\nasync function fetchImages({ onSuccess, onError, onFinally }) {\n  try {\n    const res = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: encodeURIComponent(currentQuery),\n        per_page: PER_PAGE,\n        page: currentPage\n      }\n    });\n    onSuccess(res.data.hits);\n  } catch (error) {\n    onError();\n  } finally {\n    onFinally();\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst MESSAGES = {\n  no_query: 'Please, enter your search query',\n  not_found: 'Sorry, no images matching search query',\n  no_more: 'Sorry, no more images to load',\n  failed: 'Sorry, images failed to fetch',\n}\n\nexport function showMessage(message) {\n  iziToast.error({\n    message: MESSAGES[message]\n  });\n}","import { showMessage } from './messages.js';\n\nexport const form = document.querySelector('.form');\nexport const gallery = document.querySelector('.gallery');\nexport const loadMoreBtn = document.querySelector('.load-more');\n\nconst detailTitles = ['Likes', 'Views', 'Comments', 'Downloads'];\n\nexport function renderGallery(images) {\n  clearGallery();\n\n  if (images.length === 0) {\n    showMessage('not_found');\n    return;\n  }\n\n  images.forEach((image) => {\n    gallery.append(getImageCart(image));\n  });\n  showGallery();\n  showLoadBtn();\n}\n\nexport function updateGallery(images) {\n  if (images.length === 0) {\n    showMessage('no_more');\n    hideLoadBtn();\n    return;\n  }\n\n  images.forEach((image) => {\n    gallery.append(getImageCart(image));\n  });\n  autoScrollOnLoadMore();\n}\n\nexport function showGallery() {\n  gallery.style.display = 'grid';\n}\n\nexport function hideGallery() {\n  gallery.style.display = 'none';\n}\n\nexport function showLoadBtn() {\n  loadMoreBtn.style.visibility = 'visible';\n}\n\nexport function hideLoadBtn() {\n  loadMoreBtn.style.visibility = 'hidden';\n}\n\nfunction clearGallery() {\n  while (gallery.lastElementChild) {\n    gallery.removeChild(gallery.lastElementChild);\n  }\n}\n\nfunction getImageCart(imgData) {\n  const { webformatURL, largeImageURL, tags } = imgData;\n\n  const cart = document.createElement('li');\n  cart.classList.add('gallery-cart');\n\n  const link = document.createElement('a');\n  link.classList.add('gallery-link');\n  link.href = largeImageURL;\n\n  const img = document.createElement('img');\n  img.classList.add('gallery-image');\n  img.src = webformatURL;\n  img.title = tags;\n\n  const details = document.createElement('div');\n  details.classList.add('gallery-details');\n  detailTitles.forEach((value) => {\n    const detail = document.createElement('div');\n    detail.classList.add('detail');\n\n    const title = document.createElement('p');\n    title.classList.add('detail-title');\n\n    const desc = document.createElement('p');\n    desc.classList.add('detail-desc');\n\n    title.innerText = value;\n    desc.innerText = imgData[value.toLowerCase()];\n\n    detail.append(title);\n    detail.append(desc);\n    details.append(detail);\n  });\n\n  link.append(img);\n  link.append(details);\n  cart.append(link);\n\n  return cart;\n}\n\nfunction autoScrollOnLoadMore() {\n  scrollBy({\n    top: gallery.children[0].getBoundingClientRect().height * 2,\n    behavior: \"smooth\",\n  });\n}\n","const spinner = document.querySelector('.loader');\n\nexport function showSpinner() {\n  spinner.style.visibility = 'visible';\n}\n\nexport function hideSpinner() {\n  spinner.style.visibility = 'hidden';\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { loadMoreSearchResults, processSearchResults } from './js/pixabay-api.js';\nimport {\n  form,\n  gallery,\n  loadMoreBtn,\n  renderGallery,\n  updateGallery,\n  hideGallery,\n  hideLoadBtn,\n  showLoadBtn\n} from './js/render-functions.js';\nimport { showSpinner, hideSpinner } from './js/spinner.js';\nimport { showMessage } from './js/messages.js';\n\nconst lightbox = new SimpleLightbox('.gallery-link');\n\nhideGallery();\nhideLoadBtn();\nhideSpinner();\n\nform.addEventListener('submit', (e) => {\n  e.preventDefault();\n\n  const searchQuery = new FormData(form).get('query');\n  if (!searchQuery) {\n    showMessage('no_query');\n    return;\n  }\n\n  processSearchResults(searchQuery, {\n    onStart: () => {\n      hideGallery();\n      hideLoadBtn();\n      showSpinner();\n    },\n    onSuccess: (images) => {\n      renderGallery(images);\n      lightbox.refresh();\n    },\n    onError: () => showMessage('failed'),\n    onFinally: hideSpinner\n  });\n});\n\ngallery.addEventListener('click', () => {\n  lightbox.open();\n});\n\nloadMoreBtn.addEventListener('click', () => {\n  loadMoreSearchResults({\n    onStart: () => {\n      hideLoadBtn();\n      showSpinner();\n    },\n    onSuccess: (images) => {\n      lightbox.refresh();\n      updateGallery(images);\n    },\n    onError: () => showMessage('failed'),\n    onFinally: () => {\n      hideSpinner();\n      showLoadBtn();\n    }\n  });\n});\n"],"names":["API_KEY","BASE_URL","PER_PAGE","currentPage","currentQuery","processSearchResults","query","onStart","onSuccess","onError","onFinally","fetchImages","loadMoreSearchResults","res","axios","MESSAGES","showMessage","message","iziToast","form","gallery","loadMoreBtn","detailTitles","renderGallery","images","clearGallery","image","getImageCart","showGallery","showLoadBtn","updateGallery","hideLoadBtn","autoScrollOnLoadMore","hideGallery","imgData","webformatURL","largeImageURL","tags","cart","link","img","details","value","detail","title","desc","spinner","showSpinner","hideSpinner","lightbox","SimpleLightbox","searchQuery"],"mappings":"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"}